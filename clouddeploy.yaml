steps:
  - name: 'gcr.io/cloud-builders/kubectl'
    env:
      - CLOUDSDK_COMPUTE_REGION=us-central1
      - CLOUDSDK_CONTAINER_CLUSTER=autopilot-cluster-1
      - KUBECONFIG=/workspace/.kube/config
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        if [ "$BRANCH_NAME" == "master" ]; then
          echo "Applying deployment.yaml"
          kubectl apply -f deployment.yaml
        else
          echo "Skipping deployment for branch $BRANCH_NAME"
        fi
